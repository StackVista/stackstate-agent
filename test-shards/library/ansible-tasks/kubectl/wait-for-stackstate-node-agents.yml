---
- name: Wait for the stackstate node agents to start doing their thing (otherwise connections might occur after agent startup)
  ignore_errors: true
  command: kubectl -n={{ namespace }} wait --all --for=condition=Ready --timeout=360s -l app.kubernetes.io/component=agent pod
  args:
    chdir: "{{ ansibleTasksDir }}/kubectl/agents"
  environment:
    KUBECONFIG: "{{ kubeconfig }}"
